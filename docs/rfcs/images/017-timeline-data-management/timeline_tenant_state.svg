<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1284px" height="892px" viewBox="-0.5 -0.5 1284 892" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-07-25T12:13:55.935Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36&quot; etag=&quot;PSExUEP8DKZdfC8-YVND&quot; version=&quot;20.2.0&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;O-UwVOdaADe9p4iTUtC-&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-375-251-332-150-0"><rect x="375" y="251" width="332" height="150"/></clipPath><clipPath id="mx-clip-375-71-332-50-0"><rect x="375" y="71" width="332" height="50"/></clipPath><clipPath id="mx-clip-755-71-362-100-0"><rect x="755" y="71" width="362" height="100"/></clipPath><clipPath id="mx-clip-525-541-322-90-0"><rect x="525" y="541" width="322" height="90"/></clipPath><clipPath id="mx-clip-895-251-362-50-0"><rect x="895" y="251" width="362" height="50"/></clipPath><clipPath id="mx-clip-25-491-302-70-0"><rect x="25" y="491" width="302" height="70"/></clipPath><clipPath id="mx-clip-25-191-302-70-0"><rect x="25" y="191" width="302" height="70"/></clipPath><clipPath id="mx-clip-895-381-362-250-0"><rect x="895" y="381" width="362" height="250"/></clipPath><clipPath id="mx-clip-25-611-302-40-0"><rect x="25" y="611" width="302" height="40"/></clipPath><clipPath id="mx-clip-25-71-302-70-0"><rect x="25" y="71" width="302" height="70"/></clipPath><clipPath id="mx-clip-25-381-302-70-0"><rect x="25" y="381" width="302" height="70"/></clipPath></defs><g><path d="M 1 21 L 1 1 L 1281 1 L 1281 21" fill="rgb(255, 255, 255)" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1 21 L 1 891 L 1281 891 L 1281 21" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1 21 L 1281 21" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" font-size="12px"><text x="2.5" y="15.5">                                             Tasks                                                                                                                                                                   State</text></g><path d="M 666 751 L 666 751 L 746 751 L 746 751" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 666 751 L 666 781 L 746 781 L 746 751" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="705.5" y="769.5">Layer 1</text></g><path d="M 756 751 L 756 751 L 836 751 L 836 751" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 756 751 L 756 781 L 836 781 L 836 751" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="795.5" y="769.5">Layer 2</text></g><path d="M 966 781 L 966 801 L 966 791 L 966 800.9" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 966 807.65 L 961.5 798.65 L 966 800.9 L 970.5 798.65 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 796px; margin-left: 966px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; background-color: rgb(255, 255, 255); white-space: nowrap;">contained in</div></div></div></foreignObject><text x="966" y="799" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">contained in</text></switch></g><path d="M 926 751 L 926 751 L 1006 751 L 1006 751" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 926 751 L 926 781 L 1006 781 L 1006 751" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="965.5" y="769.5">metadata</text></g><path d="M 666 811 L 666 811 L 746 811 L 746 811" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 666 811 L 666 841 L 746 841 L 746 811" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="705.5" y="829.5">Layer 1</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 826px; margin-left: 871px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap;">...</div></div></div></foreignObject><text x="871" y="830" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 776px; margin-left: 871px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap;">...</div></div></div></foreignObject><text x="871" y="780" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">...</text></switch></g><path d="M 911 811 L 911 811 L 1021 811 L 1021 811" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 911 811 L 911 841 L 1021 841 L 1021 811" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="965.5" y="829.5">index_part.json</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 826px; margin-left: 1171px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap;">Files in the remote storage</div></div></div></foreignObject><text x="1171" y="830" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Files in the remote storage</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 771px; margin-left: 1156px;"><div data-drawio-colors="color: #000000; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap;">Files in the local FS</div></div></div></foreignObject><text x="1156" y="775" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Files in the local FS</text></switch></g><path d="M 371 251 L 371 221 L 711 221 L 711 251" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 371 251 L 371 401 L 711 401 L 711 251" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 371 251 L 711 251" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="540.5" y="240.5">LayeredRepository</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-375-251-332-150-0)" font-size="12px"><text x="376.5" y="267.5">timelines: Mutex&lt;HashMap&lt;TimelineId, LayeredTimeline&gt;&gt;</text><text x="376.5" y="295.5">gc_cs: Mutex&lt;()&gt;</text><text x="376.5" y="323.5">file_lock: RwLock&lt;()&gt;</text><text x="376.5" y="351.5">tenant_conf: Arc&lt;RwLock&lt;TenantConfOpt&gt;&gt;</text><text x="376.5" y="379.5">remote_index: Arc&lt;RwLock&lt;HashMap&lt;</text><text x="376.5" y="393.5">                        TenantTimelineId, RemoteTimelineMetadata&gt;&gt;</text></g><path d="M 371 71 L 371 41 L 711 41 L 711 71" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 371 71 L 371 121 L 711 121 L 711 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 371 71 L 711 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="540.5" y="60.5">tenant_mgr</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-375-71-332-50-0)" font-size="12px"><text x="376.5" y="97.5">static ref TENANTS: RwLock&lt;HashMap&lt;TenantId, Tenant&gt;&gt;</text></g><path d="M 751 71 L 751 41 L 1121 41 L 1121 71" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 751 71 L 751 171 L 1121 171 L 1121 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 751 71 L 1121 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="935.5" y="60.5">Tenant</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-755-71-362-100-0)" font-size="12px"><text x="756.5" y="97.5">state: TenantState</text><text x="756.5" y="125.5">repo: Arc&lt;LayeredRepository&gt;</text><text x="756.5" y="153.5">local_timelines: HashMap&lt;TimelineId, Arc&lt;DatadirTimelineImpl&gt;&gt;</text></g><path d="M 690.94 78.15 L 740.97 72.19" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 747.67 71.4 L 739.26 76.93 L 740.97 72.19 L 738.2 67.99 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 751 121 L 550.12 216.66" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 544.03 219.56 L 550.22 211.63 L 550.12 216.66 L 554.09 219.75 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 521 541 L 521 511 L 851 511 L 851 541" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 521 541 L 521 631 L 851 631 L 851 541" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 521 541 L 851 541" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="685.5" y="530.5">PageCache</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-525-541-322-90-0)" font-size="12px"><text x="526.5" y="562.5">materialized_page_map: RwLock&lt;HashMap&lt;...&gt;&gt;</text><text x="526.5" y="590.5">ephemeral_page_map: RwLock&lt;HashMap&lt;...&gt;&gt;</text><text x="526.5" y="618.5">immutable_page_map: RwLock&lt;HashMap&lt;...&gt;&gt;</text></g><path d="M 891 251 L 891 221 L 1261 221 L 1261 251" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 891 251 L 891 301 L 1261 301 L 1261 251" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 891 251 L 1261 251" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1075.5" y="240.5">DatadirTimelineImpl</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-895-251-362-50-0)" font-size="12px"><text x="896.5" y="263.5">partitioning: Mutex&lt;(KeyPartitioning, Lsn)&gt;</text><text x="896.5" y="291.5">tline: Arc&lt;LayeredTimeline&gt;</text></g><path d="M 1041.08 161 L 1070.92 212.27" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 1074.31 218.1 L 1065.9 212.59 L 1070.92 212.27 L 1073.68 208.06 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 491 L 21 461 L 331 461 L 331 491" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 491 L 21 561 L 331 561 L 331 491" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 491 L 331 491" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="175.5" y="480.5">compaction</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-25-491-302-70-0)" font-size="12px"><text x="26.5" y="509.5">Periodically runs on all tenant timelines, </text><text x="26.5" y="523.5">each processed separately. </text><text x="26.5" y="551.5">Merges (removes and adds) layer files</text></g><path d="M 21 191 L 21 161 L 331 161 L 331 191" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 191 L 21 261 L 331 261 L 331 191" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 191 L 331 191" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="175.5" y="180.5">walreceiver tasks</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-25-191-302-70-0)" font-size="12px"><text x="26.5" y="223.5">etcd subscriptions, periodic timeline writes </text><text x="26.5" y="237.5">and checkpoints</text></g><path d="M 476 751 L 476 751 L 616 751 L 616 751" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 476 751 L 476 781 L 616 781 L 616 751" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="545.5" y="769.5">tenant config file</text></g><path d="M 891 381 L 891 351 L 1261 351 L 1261 381" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 891 381 L 891 631 L 1261 631 L 1261 381" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 891 381 L 1261 381" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1075.5" y="370.5">LayeredTimeline</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-895-381-362-250-0)" font-size="12px"><text x="896.5" y="405.5">write_lock: Mutex&lt;()&gt;</text><text x="896.5" y="433.5">layer_flush_lock: Mutex&lt;()&gt;</text><text x="896.5" y="461.5">layer_removal_cs: Mutex&lt;()&gt;</text><text x="896.5" y="489.5">latest_gc_cutoff_lsn: RwLock&lt;Lsn&gt;</text><text x="896.5" y="517.5">tenant_conf: Arc&lt;RwLock&lt;TenantConfOpt&gt;&gt;</text><text x="896.5" y="545.5">gc_info: RwLock&lt;GcInfo&gt;</text><text x="896.5" y="573.5">process: Mutex&lt;Option&lt;PostgresRedoPorcess&gt;&gt; inside</text><text x="896.5" y="587.5">               PostgresRedoManager</text><text x="896.5" y="615.5">layers: RwLock&lt;LayerMap&gt;</text></g><path d="M 700.8 272.45 L 1066.11 348.93" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 1072.72 350.31 L 1062.99 352.87 L 1066.11 348.93 L 1064.83 344.06 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 1010.88 291 L 1068.57 344.15" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 1073.53 348.73 L 1063.87 345.94 L 1068.57 344.15 L 1069.96 339.32 Z" fill="#000000" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 611 L 21 581 L 331 581 L 331 611" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 611 L 21 651 L 331 651 L 331 611" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 611 L 331 611" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="175.5" y="600.5">layer flush task</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-25-611-302-40-0)" font-size="12px"><text x="26.5" y="628.5">Per timeline, moves in-memory data to disk </text><text x="26.5" y="642.5">when scheduled (adds layers)</text></g><path d="M 695.41 507.33 L 881.59 434.67" fill="none" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 689.12 509.78 L 695.87 502.32 L 695.41 507.33 L 699.14 510.7 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 887.88 432.22 L 881.13 439.68 L 881.59 434.67 L 877.86 431.3 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 1 671 L 1281 670" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 71 L 21 41 L 331 41 L 331 71" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 71 L 21 141 L 331 141 L 331 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 71 L 331 71" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="175.5" y="60.5">remote storage sync task</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-25-71-302-70-0)" font-size="12px"><text x="26.5" y="103.5">storage sync queue and S3 connections</text><text x="26.5" y="117.5">periodically writes into the remote index</text></g><path d="M 21 381 L 21 351 L 331 351 L 331 381" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 381 L 21 451 L 331 451 L 331 381" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 381 L 331 381" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="175.5" y="370.5">gc</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-25-381-302-70-0)" font-size="12px"><text x="26.5" y="399.5">Periodically runs on all tenant timelines, </text><text x="26.5" y="413.5">with shared context.</text><text x="26.5" y="441.5">Removes layer files</text></g><path d="M 351 301 L 1 301" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 326px; margin-left: 176px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: nowrap;">Backed by repository:</div></div></div></foreignObject><text x="176" y="330" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Backed by repository:</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 471px; margin-left: 781px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; background-color: rgb(255, 255, 255); white-space: nowrap;"><font color="#ff1a12">get page requests lookup and update</font></div></div></div></foreignObject><text x="781" y="475" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">get page requests lookup and update</text></switch></g><path d="M 437.91 760.68 L 434.01 413.65" fill="none" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 437.98 767.43 L 433.38 758.48 L 437.91 760.68 L 442.38 758.38 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 433.94 406.9 L 438.54 415.85 L 434.01 413.65 L 429.54 415.95 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 701px; margin-left: 541px;"><div data-drawio-colors="color: #FF1A12; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(255, 26, 18); line-height: 1.2; pointer-events: none; background-color: rgb(255, 255, 255); white-space: nowrap;">flushes new files on disk, loads existing into memory</div></div></div></foreignObject><text x="541" y="705" fill="#FF1A12" font-family="Helvetica" font-size="11px" text-anchor="middle">flushes new files on disk, loads existing into memory</text></switch></g><path d="M 421.44 766.74 L 150.56 674.26" fill="none" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 427.83 768.92 L 417.85 770.27 L 421.44 766.74 L 420.76 761.75 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 144.17 672.08 L 154.15 670.73 L 150.56 674.26 L 151.24 679.25 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 722px; margin-left: 221px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; background-color: rgb(255, 255, 255); white-space: nowrap;"><font color="#ff1a12">Tasks interact with files on disk, full CRUD<br />Remote storage sync task is the only one to interact with other storage</font></div></div></div></foreignObject><text x="221" y="725" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">Tasks interact with files on disk, full CRUD...</text></switch></g><path d="M 441.04 240.98 L 337.38 113.83" fill="none" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><path d="M 333.12 108.6 L 342.29 112.73 L 337.38 113.83 L 335.32 118.42 Z" fill="#ff1a12" stroke="#ff1a12" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 171px; margin-left: 411px;"><div data-drawio-colors="color: #000000; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; background-color: rgb(255, 255, 255); white-space: nowrap;"><font color="#ff1a12">schedules layer sync</font></div></div></div></foreignObject><text x="411" y="175" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">schedules layer sync</text></switch></g><path d="M 350 671 L 351 1" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>